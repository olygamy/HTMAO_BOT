Scotland bans controversial gas extraction technique