Record heatwave pushes hospitals into emergency measures